"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[5889],{5889:(j,D,l)=>{l.r(D),l.d(D,{RentalDetailPageModule:()=>T});var p=l(2881),u=l(4341),r=l(9420),_=l(9870),m=l(467),e=l(1360),b=l(1553),f=l(9198),y=l(4796);function k(a,s){1&a&&(e.j41(0,"div",6),e.nrm(1,"ion-spinner",7),e.k0s())}function C(a,s){1&a&&(e.j41(0,"ion-note",25),e.EFF(1," Layanan diantar tersedia di area jabodetabek saja. "),e.k0s())}function P(a,s){if(1&a&&(e.j41(0,"div",21)(1,"span"),e.EFF(2,"Biaya Antar"),e.k0s(),e.j41(3,"span"),e.EFF(4),e.nI1(5,"currency"),e.k0s()()),2&a){const i=e.XpG(2);e.R7$(4),e.JRh(e.ii3(5,1,i.deliveryCost,"Rp ","symbol","1.0-0"))}}function M(a,s){if(1&a){const i=e.RV6();e.j41(0,"div")(1,"ion-item",8)(2,"ion-thumbnail",1),e.nrm(3,"img",9),e.k0s(),e.j41(4,"ion-label")(5,"h2"),e.EFF(6),e.k0s(),e.j41(7,"div",10),e.EFF(8),e.k0s(),e.j41(9,"p",11),e.EFF(10),e.nI1(11,"currency"),e.k0s()()(),e.j41(12,"div",12)(13,"h3",13),e.EFF(14,"Select Rental Period"),e.k0s(),e.j41(15,"ion-list")(16,"ion-item")(17,"ion-label"),e.EFF(18,"Pickup Date & Time"),e.k0s(),e.nrm(19,"ion-datetime-button",14),e.k0s(),e.j41(20,"ion-item")(21,"ion-label"),e.EFF(22,"Return Date & Time"),e.k0s(),e.j41(23,"div",15)(24,"span"),e.EFF(25),e.nI1(26,"date"),e.k0s(),e.j41(27,"span"),e.EFF(28),e.nI1(29,"date"),e.k0s()()()(),e.j41(30,"h3",13),e.EFF(31,"Driver Options"),e.k0s(),e.j41(32,"ion-radio-group",16),e.mxI("ngModelChange",function(n){e.eBV(i);const o=e.XpG();return e.DH7(o.driverOption,n)||(o.driverOption=n),e.Njj(n)}),e.bIt("ionChange",function(){e.eBV(i);const n=e.XpG();return e.Njj(n.onSelectionChange())}),e.j41(33,"ion-item")(34,"ion-label"),e.EFF(35,"Pickup"),e.k0s(),e.nrm(36,"ion-radio",17),e.k0s(),e.j41(37,"ion-item")(38,"ion-label"),e.EFF(39," Diantar "),e.j41(40,"p"),e.EFF(41),e.nI1(42,"currency"),e.k0s()(),e.nrm(43,"ion-radio",18),e.k0s()(),e.DNE(44,C,2,0,"ion-note",19),e.j41(45,"h3",13),e.EFF(46,"Payment Summary"),e.k0s(),e.j41(47,"div",20)(48,"div",21)(49,"span"),e.EFF(50),e.k0s(),e.j41(51,"span"),e.EFF(52),e.nI1(53,"currency"),e.k0s()(),e.DNE(54,P,6,6,"div",22),e.j41(55,"div",21)(56,"span"),e.EFF(57,"Security Deposit (Refundable)"),e.k0s(),e.j41(58,"span"),e.EFF(59),e.nI1(60,"currency"),e.k0s()(),e.nrm(61,"ion-item-divider"),e.j41(62,"div",23)(63,"span"),e.EFF(64,"Total"),e.k0s(),e.j41(65,"span"),e.EFF(66),e.nI1(67,"currency"),e.k0s()()(),e.j41(68,"ion-button",24),e.bIt("click",function(){e.eBV(i);const n=e.XpG();return e.Njj(n.confirmBooking())}),e.EFF(69,"CONTINUE TO PAYMENT"),e.k0s()()()}if(2&a){const i=e.XpG();e.R7$(3),e.Y8G("src","http://127.0.0.1:8000"+i.vehicle.foto_utama,e.B4B),e.R7$(3),e.JRh(i.vehicle.nama),e.R7$(2),e.SpI("",i.rentalDuration," Days Package"),e.R7$(2),e.SpI(" ",e.ii3(11,19,i.vehicle.harga_sewa_harian,"Rp ","symbol","1.0-0"),"/day "),e.R7$(15),e.JRh(e.i5U(26,24,i.returnDateTimeDisplay,"d MMM, y")),e.R7$(3),e.JRh(e.i5U(29,27,i.returnDateTimeDisplay,"HH:mm")),e.R7$(4),e.R50("ngModel",i.driverOption),e.R7$(),e.AVh("item-selected","pickup"===i.driverOption),e.R7$(4),e.AVh("item-selected","delivered"===i.driverOption),e.R7$(4),e.SpI(" Additional ",e.ii3(42,30,i.FLAT_DELIVERY_FEE,"Rp ","symbol","1.0-0")," "),e.R7$(3),e.Y8G("ngIf","delivered"===i.driverOption),e.R7$(6),e.SpI("",i.rentalDuration," Days Rental"),e.R7$(2),e.JRh(e.ii3(53,35,i.rentalCost,"Rp ","symbol","1.0-0")),e.R7$(2),e.Y8G("ngIf",i.deliveryCost>0),e.R7$(5),e.JRh(e.ii3(60,40,i.vehicle.security_deposit,"Rp ","symbol","1.0-0")),e.R7$(7),e.JRh(e.ii3(67,45,i.totalCost,"Rp ","symbol","1.0-0")),e.R7$(2),e.Y8G("disabled",i.isLoading||i.isProfileLoading)}}function O(a,s){if(1&a){const i=e.RV6();e.j41(0,"ion-datetime",26),e.mxI("ngModelChange",function(n){e.eBV(i);const o=e.XpG();return e.DH7(o.pickupDateTime,n)||(o.pickupDateTime=n),e.Njj(n)}),e.bIt("ionChange",function(){e.eBV(i);const n=e.XpG();return e.Njj(n.onPickupTimeChange())}),e.k0s()}if(2&a){const i=e.XpG();e.R50("ngModel",i.pickupDateTime),e.Y8G("min",i.minPickupDate)("hourValues",i.allowedHours)("isDateEnabled",i.isDateEnabled)}}const R=[{path:"",component:(()=>{var a;class s{constructor(t,n,o,d,h,v){this.route=t,this.vehicleService=n,this.router=o,this.loadingController=d,this.alertController=h,this.authService=v,this.vehicle=null,this.isLoading=!0,this.isProfileLoading=!0,this.pickupDateTime=(new Date).toISOString(),this.returnDateTime=(new Date).toISOString(),this.returnDateTimeDisplay="",this.bookedDates=[],this.rentalDuration=1,this.minPickupDate="",this.driverOption="pickup",this.rentalCost=0,this.deliveryCost=0,this.totalCost=0,this.FLAT_DELIVERY_FEE=15e4,this.userAddress="",this.allowedHours=[8,9,10,11,12,13,14,15,16,17,18,19,20,21],this.isUserInJabodetabek=!0,this.isDateEnabled=F=>{const I=F.split("T")[0];return!this.bookedDates.includes(I)};const g=this.router.getCurrentNavigation(),c=null==g?void 0:g.extras.state;null!=c&&c.prefill&&(this.rentalDuration=c.prefill.durationInDays)}ngOnInit(){this.getAuthenticatedUser();const t=this.route.snapshot.paramMap.get("id");t?this.loadVehicleDetails(t):(this.isLoading=!1,console.error("ID Mobil tidak ditemukan di URL")),this.setInitialDates()}getAuthenticatedUser(){this.isProfileLoading=!0,this.authService.getProfile().subscribe({next:t=>{this.userAddress=t.alamat||"Alamat tidak ditemukan",this.isProfileLoading=!1},error:t=>{console.error("Gagal mengambil profil:",t),this.userAddress="Gagal memuat alamat",this.isProfileLoading=!1}})}setInitialDates(){const t=new Date,n=new Date;t.getHours()>=22&&n.setDate(n.getDate()+1),n.setHours(0,0,0,0),this.minPickupDate=n.toISOString();const o=new Date(this.minPickupDate);o.getHours()<8&&o.setHours(8,0,0,0),this.pickupDateTime=o.toISOString(),this.updateReturnDateTime()}loadVehicleDetails(t){var n=this;return(0,m.A)(function*(){n.isLoading=!0,n.vehicleService.getVehicleById(t).subscribe({next:o=>{n.vehicle=o.data,n.calculateTotal(),n.isLoading=!1,n.loadBookedDates(n.vehicle.id)},error:o=>{console.error("Gagal memuat detail mobil:",o),n.isLoading=!1}})})()}loadBookedDates(t){this.vehicleService.getBookedDates(t).subscribe({next:n=>{this.bookedDates=n.data,console.log("Tanggal yang tidak tersedia:",this.bookedDates)},error:n=>{console.error("Gagal mengambil tanggal yang dibooking:",n)}})}calculateTotal(){this.vehicle&&(this.rentalCost=this.rentalDuration*this.vehicle.harga_sewa_harian,this.deliveryCost="delivered"===this.driverOption?this.FLAT_DELIVERY_FEE:0,this.totalCost=this.rentalCost+this.deliveryCost+Number(this.vehicle.security_deposit))}onPickupTimeChange(){this.updateReturnDateTime(),this.calculateTotal()}updateReturnDateTime(){const t=new Date(this.pickupDateTime),n=24*this.rentalDuration*60*60*1e3,o=new Date(t.getTime()+n);this.returnDateTime=o.toISOString(),this.returnDateTimeDisplay=o.toLocaleString("id-ID",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit",hour12:!1,timeZone:"Asia/Jakarta"}).replace(/\./g,":")}onSelectionChange(){"delivered"!==this.driverOption||this.isUserInJabodetabek?this.calculateTotal():this.presentDeliveryAlert()}presentDeliveryAlert(){var t=this;return(0,m.A)(function*(){const n=yield t.alertController.create({header:"Oops!",message:"Lokasi Anda berada di luar wilayah Jabodetabek. Layanan pengantaran belum tersedia di area ini. Silakan pilih opsi ambil sendiri.",buttons:["OK"],backdropDismiss:!1});yield n.present(),yield n.onDidDismiss(),t.driverOption="pickup",t.calculateTotal()})()}formatISODateToYmdHis(t){const n=new Date(t);return`${n.getFullYear()}-${(n.getMonth()+1).toString().padStart(2,"0")}-${n.getDate().toString().padStart(2,"0")} ${n.getHours().toString().padStart(2,"0")}:${n.getMinutes().toString().padStart(2,"0")}:${n.getSeconds().toString().padStart(2,"0")}`}confirmBooking(){var t=this;return(0,m.A)(function*(){const n=new Date(t.pickupDateTime),o=new Date;if(o.setHours(0,0,0,0),n<o)t.presentAlert("Tanggal Tidak Valid","Anda tidak dapat memilih tanggal yang sudah berlalu. Silakan pilih hari ini atau tanggal di masa mendatang.");else if("delivered"!==t.driverOption||t.userAddress&&!t.userAddress.includes("ditemukan")){if(t.vehicle){t.calculateTotal();const d={car:t.vehicle,duration:t.rentalDuration,pickup:t.formatISODateToYmdHis(t.pickupDateTime),return:t.formatISODateToYmdHis(t.returnDateTime),driverOption:t.driverOption,cost:t.rentalCost,delivery:t.deliveryCost,deliveryAddress:"delivered"===t.driverOption?t.userAddress:""};t.router.navigate(["/payment-method"],{state:{data:d}})}}else t.presentAlert("Alamat Tidak Ditemukan","Alamat Anda belum terdaftar di profil. Silakan perbarui profil Anda terlebih dahulu.")})()}presentAlert(t,n){var o=this;return(0,m.A)(function*(){yield(yield o.alertController.create({header:t,message:n,buttons:["OK"]})).present()})()}}return(a=s).\u0275fac=function(t){return new(t||a)(e.rXU(b.nX),e.rXU(f.K),e.rXU(b.Ix),e.rXU(r.Xi),e.rXU(r.hG),e.rXU(y.u))},a.\u0275cmp=e.VBU({type:a,selectors:[["app-rental-detail"]],standalone:!1,decls:11,vars:3,consts:[["color","primary"],["slot","start"],["defaultHref","/home"],["class","ion-text-center ion-padding",4,"ngIf"],[4,"ngIf"],[3,"keepContentsMounted"],[1,"ion-text-center","ion-padding"],["name","crescent"],["lines","none",1,"car-info-header"],[3,"src"],[1,"package-chip"],[1,"price"],[1,"ion-padding"],[1,"section-title"],["datetime","pickupDatetime"],[1,"fake-datetime-button"],[3,"ngModelChange","ionChange","ngModel"],["slot","end","value","pickup"],["slot","end","value","delivered"],["class","delivery-note",4,"ngIf"],[1,"payment-summary"],[1,"summary-item"],["class","summary-item",4,"ngIf"],[1,"summary-item","total"],["expand","block",3,"click","disabled"],[1,"delivery-note"],["id","pickupDatetime","hour-cycle","h23",3,"ngModelChange","ionChange","ngModel","min","hourValues","isDateEnabled"]],template:function(t,n){1&t&&(e.j41(0,"ion-header")(1,"ion-toolbar",0)(2,"ion-buttons",1),e.nrm(3,"ion-back-button",2),e.k0s(),e.j41(4,"ion-title"),e.EFF(5,"Rental Details"),e.k0s()()(),e.j41(6,"ion-content"),e.DNE(7,k,2,0,"div",3)(8,M,70,50,"div",4),e.j41(9,"ion-modal",5),e.DNE(10,O,1,4,"ng-template"),e.k0s()()),2&t&&(e.R7$(7),e.Y8G("ngIf",n.isLoading),e.R7$(),e.Y8G("ngIf",!n.isLoading&&n.vehicle),e.R7$(),e.Y8G("keepContentsMounted",!0))},dependencies:[p.bT,u.BC,u.vS,r.Jm,r.QW,r.W9,r.A9,r.K4,r.eU,r.uz,r.Dg,r.he,r.nf,r.JI,r.KO,r.f0,r.w2,r.Zx,r.BC,r.ai,r.Sb,r.Je,r.el,p.oe,p.vh],styles:["[_nghost-%COMP%]   ion-toolbar[_ngcontent-%COMP%]{--background: var(--ion-color-primary);--color: var(--ion-color-primary-contrast)}[_nghost-%COMP%]   ion-content[_ngcontent-%COMP%]{--background: var(--ion-background-color)}[_nghost-%COMP%]   .car-info-header[_ngcontent-%COMP%]{--background: var(--ion-item-background);--padding-start: 16px;--padding-end: 16px;--padding-top: 16px;--padding-bottom: 16px;border-bottom:1px solid var(--ion-border-color, #eee)}[_nghost-%COMP%]   .car-info-header[_ngcontent-%COMP%]   ion-thumbnail[_ngcontent-%COMP%]{width:150px;height:70px;border-radius:8px;--border-radius: 8px}[_nghost-%COMP%]   .car-info-header[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:1.4rem;font-weight:700;margin-bottom:6px;color:var(--ion-text-color)}[_nghost-%COMP%]   .car-info-header[_ngcontent-%COMP%]   .package-chip[_ngcontent-%COMP%]{font-size:.9rem;font-weight:500;background:rgba(var(--ion-color-primary-rgb),.1);color:var(--ion-color-primary-shade);padding:4px 10px;border-radius:20px;display:inline-block;margin-bottom:6px}[_nghost-%COMP%]   .car-info-header[_ngcontent-%COMP%]   .price[_ngcontent-%COMP%]{font-size:1.2rem;font-weight:700;color:var(--ion-text-color)}[_nghost-%COMP%]   .section-title[_ngcontent-%COMP%]{font-size:1rem;font-weight:700;color:var(--ion-text-color);margin-top:24px;margin-bottom:12px}[_nghost-%COMP%]   ion-list[_ngcontent-%COMP%]{background:transparent;padding:0}[_nghost-%COMP%]   ion-item[_ngcontent-%COMP%]{--background: var(--ion-item-background);--border-radius: 8px;margin-bottom:12px;border:1px solid var(--ion-border-color, #eee)}[_nghost-%COMP%]   ion-item[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{color:var(--ion-color-medium-shade);margin-right:8px}[_nghost-%COMP%]   ion-item[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:.8rem;color:var(--ion-color-medium-shade)}[_nghost-%COMP%]   .item-selected[_ngcontent-%COMP%]{border:1px solid var(--ion-color-primary);--background: rgba(var(--ion-color-primary-rgb), .1)}[_nghost-%COMP%]   .delivery-note[_ngcontent-%COMP%]{display:block;padding:8px 16px;margin-top:-8px;margin-bottom:16px;background:#fffbe6;border-radius:0 0 8px 8px;font-size:.8rem;color:#8a6d3b}[_nghost-%COMP%]   .payment-summary[_ngcontent-%COMP%]{background:var(--ion-item-background);padding:16px;border-radius:12px;border:1px solid var(--ion-border-color)}[_nghost-%COMP%]   .payment-summary[_ngcontent-%COMP%]   .summary-item[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:12px;font-size:.95rem}[_nghost-%COMP%]   .payment-summary[_ngcontent-%COMP%]   .summary-item[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]:first-child{color:var(--ion-color-medium-shade)}[_nghost-%COMP%]   .payment-summary[_ngcontent-%COMP%]   .summary-item[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]:last-child{font-weight:500;color:var(--ion-text-color)}[_nghost-%COMP%]   .payment-summary[_ngcontent-%COMP%]   .summary-item.total[_ngcontent-%COMP%]{font-weight:700;font-size:1.1rem;margin-top:12px;padding-top:12px;border-top:1px solid var(--ion-border-color)}[_nghost-%COMP%]   .payment-summary[_ngcontent-%COMP%]   .summary-item.total[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]:first-child, [_nghost-%COMP%]   .payment-summary[_ngcontent-%COMP%]   .summary-item.total[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]:last-child{color:var(--ion-text-color)}[_nghost-%COMP%]   .payment-summary[_ngcontent-%COMP%]   .summary-item.total[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]:last-child{color:var(--ion-color-primary)}[_nghost-%COMP%]   .payment-summary[_ngcontent-%COMP%]   ion-item-divider[_ngcontent-%COMP%]{display:none}",".fake-datetime-button[_ngcontent-%COMP%]{--background: #f2f2f2;--padding-start: 10px;--padding-end: 10px;--padding-top: 10px;--padding-bottom: 10px;background:var(--background);padding:var(--padding-top) var(--padding-end) var(--padding-bottom) var(--padding-start);border-radius:6px;display:flex;justify-content:space-between;width:53%;color:var(--ion-color-step-850, #262626);font-size:1rem;box-sizing:border-box;height:57%;align-items:center}"]}),s})()}];let x=(()=>{var a;class s{}return(a=s).\u0275fac=function(t){return new(t||a)},a.\u0275mod=e.$C({type:a}),a.\u0275inj=e.G2t({imports:[_.iI.forChild(R),_.iI]}),s})(),T=(()=>{var a;class s{}return(a=s).\u0275fac=function(t){return new(t||a)},a.\u0275mod=e.$C({type:a}),a.\u0275inj=e.G2t({imports:[p.MD,u.YN,r.bv,x]}),s})()}}]);