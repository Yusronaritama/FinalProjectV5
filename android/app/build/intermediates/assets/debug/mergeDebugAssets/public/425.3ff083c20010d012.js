"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[425],{425:(F,_,l)=>{l.r(_),l.d(_,{RentalCustomPageModule:()=>T});var c=l(2881),m=l(4341),a=l(9420),b=l(9870),u=l(467),t=l(1360),y=l(1553),v=l(9198),f=l(4796);function P(o,s){1&o&&(t.j41(0,"div",6),t.nrm(1,"ion-spinner",7),t.k0s())}function O(o,s){1&o&&(t.j41(0,"ion-note",31),t.EFF(1," Layanan diantar tersedia di area jabodetabek saja. "),t.k0s())}function k(o,s){if(1&o&&(t.j41(0,"div",27)(1,"span"),t.EFF(2,"Biaya Antar"),t.k0s(),t.j41(3,"span"),t.EFF(4),t.nI1(5,"currency"),t.k0s()()),2&o){const i=t.XpG(2);t.R7$(4),t.JRh(t.ii3(5,1,i.deliveryCost,"Rp ","symbol","1.0-0"))}}function D(o,s){if(1&o){const i=t.RV6();t.j41(0,"div")(1,"ion-item",8)(2,"ion-thumbnail",1),t.nrm(3,"img",9),t.k0s(),t.j41(4,"ion-label")(5,"h2"),t.EFF(6),t.k0s(),t.j41(7,"p",10),t.EFF(8),t.nI1(9,"currency"),t.k0s()()(),t.j41(10,"div",11)(11,"h3",12),t.EFF(12,"Select Rental Duration"),t.k0s(),t.j41(13,"div",13)(14,"ion-button",14),t.bIt("click",function(){t.eBV(i);const e=t.XpG();return t.Njj(e.decrementDays())}),t.nrm(15,"ion-icon",15),t.k0s(),t.j41(16,"div",16),t.EFF(17),t.j41(18,"span",17),t.EFF(19,"Days"),t.k0s()(),t.j41(20,"ion-button",18),t.bIt("click",function(){t.eBV(i);const e=t.XpG();return t.Njj(e.incrementDays())}),t.nrm(21,"ion-icon",19),t.k0s()(),t.j41(22,"h3",12),t.EFF(23,"Select Rental Period"),t.k0s(),t.j41(24,"ion-list")(25,"ion-item")(26,"ion-label"),t.EFF(27,"Pickup Date & Time"),t.k0s(),t.nrm(28,"ion-datetime-button",20),t.k0s(),t.j41(29,"ion-item")(30,"ion-label"),t.EFF(31,"Return Date & Time"),t.k0s(),t.j41(32,"div",21)(33,"span"),t.EFF(34),t.nI1(35,"date"),t.k0s(),t.j41(36,"span"),t.EFF(37),t.nI1(38,"date"),t.k0s()()()(),t.j41(39,"h3",12),t.EFF(40,"Driver Options"),t.k0s(),t.j41(41,"ion-radio-group",22),t.mxI("ngModelChange",function(e){t.eBV(i);const r=t.XpG();return t.DH7(r.driverOption,e)||(r.driverOption=e),t.Njj(e)}),t.bIt("ionChange",function(){t.eBV(i);const e=t.XpG();return t.Njj(e.onDriverOptionChange())}),t.j41(42,"ion-item")(43,"ion-label"),t.EFF(44,"Pickup"),t.k0s(),t.nrm(45,"ion-radio",23),t.k0s(),t.j41(46,"ion-item")(47,"ion-label"),t.EFF(48," Diantar "),t.j41(49,"p"),t.EFF(50),t.nI1(51,"currency"),t.k0s()(),t.nrm(52,"ion-radio",24),t.k0s()(),t.DNE(53,O,2,0,"ion-note",25),t.j41(54,"h3",12),t.EFF(55,"Payment Summary"),t.k0s(),t.j41(56,"div",26)(57,"div",27)(58,"span"),t.EFF(59),t.k0s(),t.j41(60,"span"),t.EFF(61),t.nI1(62,"currency"),t.k0s()(),t.DNE(63,k,6,6,"div",28),t.j41(64,"div",27)(65,"span"),t.EFF(66,"Security Deposit (Refundable)"),t.k0s(),t.j41(67,"span"),t.EFF(68),t.nI1(69,"currency"),t.k0s()(),t.nrm(70,"ion-item-divider"),t.j41(71,"div",29)(72,"span"),t.EFF(73,"Total"),t.k0s(),t.j41(74,"span"),t.EFF(75),t.nI1(76,"currency"),t.k0s()()(),t.j41(77,"ion-button",30),t.bIt("click",function(){t.eBV(i);const e=t.XpG();return t.Njj(e.goToPayment())}),t.EFF(78," Continue "),t.k0s()()()}if(2&o){const i=t.XpG();t.R7$(3),t.Y8G("src","http://127.0.0.1:8000"+i.vehicle.foto_utama,t.B4B),t.R7$(3),t.JRh(i.vehicle.nama),t.R7$(2),t.SpI(" Base price: ",t.ii3(9,19,i.vehicle.harga_sewa_harian,"Rp ","symbol","1.0-0"),"/day "),t.R7$(6),t.Y8G("disabled",i.numberOfDays<=1),t.R7$(3),t.SpI(" ",i.numberOfDays," "),t.R7$(17),t.JRh(t.i5U(35,24,i.returnDateTimeDisplay,"d MMM, y")),t.R7$(3),t.JRh(t.i5U(38,27,i.returnDateTimeDisplay,"HH:mm")),t.R7$(4),t.R50("ngModel",i.driverOption),t.R7$(),t.AVh("item-selected","pickup"===i.driverOption),t.R7$(4),t.AVh("item-selected","delivered"===i.driverOption),t.R7$(4),t.SpI(" Additional ",t.ii3(51,30,i.FLAT_DELIVERY_FEE,"Rp ","symbol","1.0-0")," "),t.R7$(3),t.Y8G("ngIf","delivered"===i.driverOption),t.R7$(6),t.SpI("",i.numberOfDays," Days Rental"),t.R7$(2),t.JRh(t.ii3(62,35,i.rentalCost,"Rp ","symbol","1.0-0")),t.R7$(2),t.Y8G("ngIf",i.deliveryCost>0),t.R7$(5),t.JRh(t.ii3(69,40,i.vehicle.security_deposit,"Rp ","symbol","1.0-0")),t.R7$(7),t.JRh(t.ii3(76,45,i.totalCost,"Rp ","symbol","1.0-0"))}}function M(o,s){if(1&o){const i=t.RV6();t.j41(0,"ion-datetime",32),t.mxI("ngModelChange",function(e){t.eBV(i);const r=t.XpG();return t.DH7(r.pickupDateTime,e)||(r.pickupDateTime=e),t.Njj(e)}),t.bIt("ionChange",function(){t.eBV(i);const e=t.XpG();return t.Njj(e.onPickupTimeChange())}),t.k0s()}if(2&o){const i=t.XpG();t.R50("ngModel",i.pickupDateTime),t.Y8G("min",i.minPickupDate)("hourValues",i.allowedHours)("isDateEnabled",i.isDateEnabled)}}const R=[{path:"",component:(()=>{var o;class s{constructor(n,e,r,d,p,g){this.route=n,this.vehicleService=e,this.alertController=r,this.router=d,this.loadingController=p,this.authService=g,this.vehicle=null,this.isLoading=!0,this.pickupDateTime=(new Date).toISOString(),this.returnDateTime=(new Date).toISOString(),this.returnDateTimeDisplay="",this.bookedDates=[],this.minPickupDate="",this.numberOfDays=1,this.driverOption="pickup",this.userAddress="",this.rentalCost=0,this.deliveryCost=0,this.totalCost=0,this.FLAT_DELIVERY_FEE=15e4,this.allowedHours=[8,9,10,11,12,13,14,15,16,17,18,19,20,21],this.isUserInJabodetabek=!0,this.isDateEnabled=h=>{const C=h.split("T")[0];return!this.bookedDates.includes(C)}}ngOnInit(){this.getAuthenticatedUser(),this.setInitialDates();const n=this.route.snapshot.paramMap.get("id");n?this.loadVehicleDetails(n):(this.isLoading=!1,console.error("ID Mobil tidak ditemukan di URL"))}getAuthenticatedUser(){this.authService.getProfile().subscribe({next:n=>{this.userAddress=n.address||n.alamat||"Alamat tidak ditemukan"},error:n=>{console.error("Gagal mengambil profil pengguna:",n),this.userAddress="Gagal memuat alamat"}})}setInitialDates(){const n=new Date,e=new Date;n.getHours()>=22&&e.setDate(e.getDate()+1),e.setHours(0,0,0,0),this.minPickupDate=e.toISOString();const r=new Date(this.minPickupDate);r.getHours()<8&&r.setHours(8,0,0,0),this.pickupDateTime=r.toISOString(),this.updateReturnDateTime()}loadVehicleDetails(n){var e=this;return(0,u.A)(function*(){const r=yield e.loadingController.create({message:"Memuat data..."});yield r.present(),e.vehicleService.getVehicleById(n).subscribe({next:d=>{e.vehicle=d.data,e.calculateTotal(),e.isLoading=!1,e.loadBookedDates(e.vehicle.id),r.dismiss()},error:d=>{console.error("Gagal memuat detail mobil:",d),e.isLoading=!1,r.dismiss()}})})()}loadBookedDates(n){this.vehicleService.getBookedDates(n).subscribe({next:e=>{this.bookedDates=e.data,console.log("Tanggal yang tidak tersedia:",this.bookedDates)},error:e=>{console.error("Gagal mengambil tanggal yang dibooking:",e)}})}presentDeliveryAlert(){var n=this;return(0,u.A)(function*(){const e=yield n.alertController.create({header:"Oops!",message:"Lokasi Anda berada di luar wilayah Jabodetabek. Layanan pengantaran belum tersedia di area ini. Silakan pilih opsi ambil sendiri.",buttons:["OK"],backdropDismiss:!1});yield e.present(),yield e.onDidDismiss(),n.driverOption="pickup",n.calculateTotal()})()}onDriverOptionChange(){"delivered"!==this.driverOption||this.isUserInJabodetabek?this.calculateTotal():this.presentDeliveryAlert()}calculateTotal(){this.vehicle&&(this.rentalCost=this.numberOfDays*this.vehicle.harga_sewa_harian,this.deliveryCost="delivered"===this.driverOption?this.FLAT_DELIVERY_FEE:0,this.totalCost=this.rentalCost+this.deliveryCost+Number(this.vehicle.security_deposit))}incrementDays(){this.numberOfDays++,this.updateReturnDateTime(),this.calculateTotal()}decrementDays(){this.numberOfDays>1&&(this.numberOfDays--,this.updateReturnDateTime(),this.calculateTotal())}onPickupTimeChange(){this.updateReturnDateTime(),this.calculateTotal()}updateReturnDateTime(){const n=new Date(this.pickupDateTime),e=24*this.numberOfDays*60*60*1e3,r=new Date(n.getTime()+e);this.returnDateTime=r.toISOString(),this.returnDateTimeDisplay=r.toLocaleString("id-ID",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit",hour12:!1,timeZone:"Asia/Jakarta"}).replace(/\./g,":")}formatISODateToYmdHis(n){const e=new Date(n);return`${e.getFullYear()}-${(e.getMonth()+1).toString().padStart(2,"0")}-${e.getDate().toString().padStart(2,"0")} ${e.getHours().toString().padStart(2,"0")}:${e.getMinutes().toString().padStart(2,"0")}:${e.getSeconds().toString().padStart(2,"0")}`}goToPayment(){const n=new Date(this.pickupDateTime),e=new Date;if(e.setHours(0,0,0,0),n<e)this.presentAlert("Tanggal Tidak Valid","Anda tidak dapat memilih tanggal yang sudah berlalu. Silakan pilih hari ini atau tanggal di masa mendatang.");else if("delivered"!==this.driverOption||this.userAddress&&!this.userAddress.includes("ditemukan")){if(this.vehicle){const r={car:this.vehicle,duration:this.numberOfDays,pickup:this.formatISODateToYmdHis(this.pickupDateTime),return:this.formatISODateToYmdHis(this.returnDateTime),cost:this.rentalCost,delivery:this.deliveryCost,total:this.totalCost,driverOption:this.driverOption,deliveryAddress:"delivered"===this.driverOption?this.userAddress:""};this.router.navigate(["/payment-method"],{state:{data:r}})}}else this.presentAlert("Alamat Tidak Ditemukan","Alamat Anda belum terdaftar di profil. Silakan perbarui profil Anda.")}presentAlert(n,e){var r=this;return(0,u.A)(function*(){yield(yield r.alertController.create({header:n,message:e,buttons:["OK"]})).present()})()}}return(o=s).\u0275fac=function(n){return new(n||o)(t.rXU(y.nX),t.rXU(v.K),t.rXU(a.hG),t.rXU(y.Ix),t.rXU(a.Xi),t.rXU(f.u))},o.\u0275cmp=t.VBU({type:o,selectors:[["app-rental-custom"]],standalone:!1,decls:11,vars:3,consts:[["color","primary"],["slot","start"],["defaultHref","/home"],["class","ion-text-center ion-padding",4,"ngIf"],[4,"ngIf"],[3,"keepContentsMounted"],[1,"ion-text-center","ion-padding"],["name","crescent"],["lines","none",1,"car-info-header"],[3,"src"],[1,"base-price"],[1,"ion-padding"],[1,"section-title"],[1,"duration-stepper"],["fill","clear",1,"stepper-btn",3,"click","disabled"],["name","remove-circle-outline"],[1,"day-count"],[1,"day-text"],["fill","clear",1,"stepper-btn",3,"click"],["name","add-circle-outline"],["datetime","pickupDatetime"],[1,"fake-datetime-button"],[3,"ngModelChange","ionChange","ngModel"],["slot","end","value","pickup"],["slot","end","value","delivered"],["class","delivery-note",4,"ngIf"],[1,"payment-summary"],[1,"summary-item"],["class","summary-item",4,"ngIf"],[1,"summary-item","total"],["expand","block","color","primary",1,"ion-margin-top",3,"click"],[1,"delivery-note"],["id","pickupDatetime","hour-cycle","h23",3,"ngModelChange","ionChange","ngModel","min","hourValues","isDateEnabled"]],template:function(n,e){1&n&&(t.j41(0,"ion-header")(1,"ion-toolbar",0)(2,"ion-buttons",1),t.nrm(3,"ion-back-button",2),t.k0s(),t.j41(4,"ion-title"),t.EFF(5,"Custom Rental"),t.k0s()()(),t.j41(6,"ion-content"),t.DNE(7,P,2,0,"div",3)(8,D,79,50,"div",4),t.j41(9,"ion-modal",5),t.DNE(10,M,1,4,"ng-template"),t.k0s()()),2&n&&(t.R7$(7),t.Y8G("ngIf",e.isLoading),t.R7$(),t.Y8G("ngIf",!e.isLoading&&e.vehicle),t.R7$(),t.Y8G("keepContentsMounted",!0))},dependencies:[c.bT,m.BC,m.vS,a.Jm,a.QW,a.W9,a.A9,a.K4,a.eU,a.iq,a.uz,a.Dg,a.he,a.nf,a.JI,a.KO,a.f0,a.w2,a.Zx,a.BC,a.ai,a.Sb,a.Je,a.el,c.oe,c.vh],styles:["[_nghost-%COMP%]   ion-toolbar[_ngcontent-%COMP%]{--background: var(--ion-color-primary);--color: var(--ion-color-primary-contrast)}[_nghost-%COMP%]   ion-content[_ngcontent-%COMP%]{--background: var(--ion-background-color)}[_nghost-%COMP%]   .car-info-header[_ngcontent-%COMP%]{--background: var(--ion-item-background);--padding-start: 16px;--padding-end: 16px;--padding-top: 16px;--padding-bottom: 16px;border-bottom:1px solid var(--ion-border-color, #eee)}[_nghost-%COMP%]   .car-info-header[_ngcontent-%COMP%]   ion-thumbnail[_ngcontent-%COMP%]{width:150px;height:70px;border-radius:8px;--border-radius: 8px}[_nghost-%COMP%]   .car-info-header[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:1.4rem;font-weight:700;margin-bottom:6px;color:var(--ion-text-color)}[_nghost-%COMP%]   .car-info-header[_ngcontent-%COMP%]   .package-chip[_ngcontent-%COMP%]{font-size:.9rem;font-weight:500;background:rgba(var(--ion-color-primary-rgb),.1);color:var(--ion-color-primary-shade);padding:4px 10px;border-radius:20px;display:inline-block;margin-bottom:6px}[_nghost-%COMP%]   .car-info-header[_ngcontent-%COMP%]   .price[_ngcontent-%COMP%]{font-size:1.2rem;font-weight:700;color:var(--ion-text-color)}[_nghost-%COMP%]   .duration-stepper[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;text-align:center;margin:16px 0;padding:8px;background-color:var(--ion-item-background);border-radius:8px;border:1px solid var(--ion-border-color, #eee)}[_nghost-%COMP%]   .duration-stepper[_ngcontent-%COMP%]   .stepper-btn[_ngcontent-%COMP%]{--padding-start: 0;--padding-end: 0}[_nghost-%COMP%]   .duration-stepper[_ngcontent-%COMP%]   .stepper-btn[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:32px;color:var(--ion-color-primary)}[_nghost-%COMP%]   .duration-stepper[_ngcontent-%COMP%]   .day-count[_ngcontent-%COMP%]{font-size:1.5rem;font-weight:700;color:var(--ion-text-color);min-width:120px;display:flex;flex-direction:column;line-height:1.2}[_nghost-%COMP%]   .duration-stepper[_ngcontent-%COMP%]   .day-count[_ngcontent-%COMP%]   .day-text[_ngcontent-%COMP%]{font-size:.8rem;font-weight:400;color:var(--ion-color-medium-shade)}[_nghost-%COMP%]   ion-list[_ngcontent-%COMP%]{background:transparent;padding:0}[_nghost-%COMP%]   ion-item[_ngcontent-%COMP%]{--background: var(--ion-item-background);--border-radius: 8px;margin-bottom:12px;border:1px solid var(--ion-border-color, #eee)}[_nghost-%COMP%]   ion-item[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{color:var(--ion-color-medium-shade);margin-right:8px}[_nghost-%COMP%]   ion-item[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:.8rem;color:var(--ion-color-medium-shade)}[_nghost-%COMP%]   .item-selected[_ngcontent-%COMP%]{border:1px solid var(--ion-color-primary);--background: rgba(var(--ion-color-primary-rgb), .1)}[_nghost-%COMP%]   .delivery-note[_ngcontent-%COMP%]{display:block;padding:8px 16px;margin-top:-8px;margin-bottom:16px;background:#fffbe6;border-radius:0 0 8px 8px;font-size:.8rem;color:#8a6d3b}[_nghost-%COMP%]   .payment-summary[_ngcontent-%COMP%]{background:var(--ion-item-background);padding:16px;border-radius:12px;border:1px solid var(--ion-border-color)}[_nghost-%COMP%]   .payment-summary[_ngcontent-%COMP%]   .summary-item[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:12px;font-size:.95rem}[_nghost-%COMP%]   .payment-summary[_ngcontent-%COMP%]   .summary-item[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]:first-child{color:var(--ion-color-medium-shade)}[_nghost-%COMP%]   .payment-summary[_ngcontent-%COMP%]   .summary-item[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]:last-child{font-weight:500;color:var(--ion-text-color)}[_nghost-%COMP%]   .payment-summary[_ngcontent-%COMP%]   .summary-item.total[_ngcontent-%COMP%]{font-weight:700;font-size:1.1rem;margin-top:12px;padding-top:12px;border-top:1px solid var(--ion-border-color)}[_nghost-%COMP%]   .payment-summary[_ngcontent-%COMP%]   .summary-item.total[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]:first-child, [_nghost-%COMP%]   .payment-summary[_ngcontent-%COMP%]   .summary-item.total[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]:last-child{color:var(--ion-text-color)}[_nghost-%COMP%]   .payment-summary[_ngcontent-%COMP%]   .summary-item.total[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]:last-child{color:var(--ion-color-primary)}[_nghost-%COMP%]   .payment-summary[_ngcontent-%COMP%]   ion-item-divider[_ngcontent-%COMP%]{display:none}",".fake-datetime-button[_ngcontent-%COMP%]{--background: #f2f2f2;--padding-start: 10px;--padding-end: 10px;--padding-top: 10px;--padding-bottom: 10px;background:var(--background);padding:var(--padding-top) var(--padding-end) var(--padding-bottom) var(--padding-start);border-radius:6px;display:flex;justify-content:space-between;width:53%;color:var(--ion-color-step-850, #262626);font-size:1rem;box-sizing:border-box;height:57%;align-items:center}"]}),s})()}];let x=(()=>{var o;class s{}return(o=s).\u0275fac=function(n){return new(n||o)},o.\u0275mod=t.$C({type:o}),o.\u0275inj=t.G2t({imports:[b.iI.forChild(R),b.iI]}),s})(),T=(()=>{var o;class s{}return(o=s).\u0275fac=function(n){return new(n||o)},o.\u0275mod=t.$C({type:o}),o.\u0275inj=t.G2t({imports:[c.MD,m.YN,a.bv,x]}),s})()}}]);